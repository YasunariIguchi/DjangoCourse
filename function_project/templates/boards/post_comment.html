{% extends "base.html" %}

{% block content %}
<div>
    <h2>過去のコメント</h2>
    {% for comment in comments %}
        <div>
            <strong>{{ comment.user.username }}</strong>: {{ comment.comment }}
        </div>
    {% empty %}
        <p>コメントはまだありません。</p>
    {% endfor %}
</div>
<form method="POST">
    {% csrf_token %} 
    {{ form.as_p }}
    <input type="button" value="一時保存" id="save_comment">
    <input type="submit" value="コメント登録">
</form>

{% endblock %}

{% block javascript %}
<script>
$("#save_comment").click(function(){
    var comment = $("#id_comment").val();
    $.ajax({
        url: "{% url 'boards:save_comment' %}",
        type:"GET",
        data: {comment: comment, theme_id: "{{theme_id}}"},
        dataType: "json",
        success: function(json){
            if(json.message){
                alert(json.message);
            }
        }
    });
});
</script>
{% endblock %}